=============================
UART通信
=============================


-----------------------------
电气特性
-----------------------------
 UART固定设置为 9600 8N1，无法修改。需要定制波特率或其他通信参数，请联系客服

 UART标准电压为3.3V，最大耐受电压5V。勿超过最大电压而引起模块损坏。

-----------------------------
通信协议
-----------------------------
 UART通信兼容MODBUS RTU协议，通信功能包括：

 1. 读取ADDR  保持寄存器0
 2. 设置ADDR  保持寄存器0
 3. 读取输出状态   线圈0
 4. 设置输出状态   线圈0
 5. 读取输入状态   离散输入0
 6. 设置单稳态触发  保持寄存器1，2

.. note::

 - 广播地址为 255， 当忘记模块地址时，可以用于找回地址，或者广播控制
 - 接收时模块内部不进行CRC校验，但为了兼容RTU协议，必须带2个CRC字节，设置为0 即可
 - 模块应答时，带CRC校验字节。 可以使用 Modbus Poll软件来测试


-----------------------------
通信示例
-----------------------------
 xx 表示任意字节

 CC 表示CRC校验码

^^^^^^^^^^^^^^^^^^^^^^^^^^
读取ADDR
^^^^^^^^^^^^^^^^^^^^^^^^^^

 读取保持寄存器0，本机地址为 1

.. code::

        000029-Tx:FF 03 00 00 00 01 91 D4
        000030-Rx:FF 03 02 00 01 50 50


^^^^^^^^^^^^^^^^^^^^^^^^^^
设置ADDR
^^^^^^^^^^^^^^^^^^^^^^^^^^

 设置保持寄存器0，地址为 1

.. code::

        000000-Tx:FF 06 00 00 00 01 5D D4
        000001-Rx:FF 06 00 00 00 01 5D D4

^^^^^^^^^^^^^^^^^^^^^^^^^^
读取输出状态
^^^^^^^^^^^^^^^^^^^^^^^^^^
 读取线圈0，当前输出值为0
 
.. code::

        000006-Tx:01 01 00 00 00 01 FD CA
        000007-Rx:01 01 01 00 51 88

^^^^^^^^^^^^^^^^^^^^^^^^^^
设置输出状态
^^^^^^^^^^^^^^^^^^^^^^^^^^
 设置线圈0，设置为on，打开继电器

.. code::

        000010-Tx:01 05 00 00 FF 00 8C 3A
        000011-Rx:01 05 00 00 FF 00 8C 3A

^^^^^^^^^^^^^^^^^^^^^^^^^^
读取输入状态
^^^^^^^^^^^^^^^^^^^^^^^^^^
 读取离散输入0，目前输入为on，高电平

.. code::

        000008-Tx:01 02 00 00 00 01 B9 CA
        000009-Rx:01 02 01 01 60 48


^^^^^^^^^^^^^^^^^^^^^^^^^^
设置单稳态触发
^^^^^^^^^^^^^^^^^^^^^^^^^^
 设置单稳态触发，保持寄存器1，2。延时时间 1000毫秒

.. code::

        #输出off 1000ms，输出on
        000000-Tx:01 10 00 01 00 02 04 00 00 03 E8 32 DD
        000001-Rx:01 10 00 01 00 02 10 08

        #反转输出 1000ms，再反转输出
        000002-Tx:01 10 00 01 00 02 04 80 00 03 E8 1B 1D
        000003-Rx:01 10 00 01 00 02 10 08

        #输出on 1000ms，输出off
        000004-Tx:01 10 00 01 00 02 04 40 00 03 E8 27 1D
        000005-Rx:01 10 00 01 00 02 10 08


.
          ======== ==========  ==================
          寄存器1  寄存器1     寄存器2
          ======== ==========  ==================
          bit15,14 bit13...0   bit15... bit0
          -------- ----------  ------------------
          暂态值   延时时间    延时时间
          ======== ==========  ==================

          寄存器1的最高2位表示操作码， 1表示暂态为on，0表示暂态为off。2表示反转。延时时间到达后，反转输出。

          延时时间计算方法为： **（寄存器1[13:0] << 16）+ 寄存器2， 单位为毫秒**

